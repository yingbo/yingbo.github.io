<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>SSH Reverse Tunnel - Yingbo Miao</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Yingbo Miao"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Yingbo Miao"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="The SSH has many advance usages. The reverse tunnel is a good example and a very useful one. It answers the question: if a user can ssh from a server A to a server B, can the user ssh back from B to A"><meta property="og:type" content="blog"><meta property="og:title" content="SSH Reverse Tunnel"><meta property="og:url" content="https://yingbo.miao.fm/2015/ssh-reverse-tunnel"><meta property="og:site_name" content="Yingbo Miao"><meta property="og:description" content="The SSH has many advance usages. The reverse tunnel is a good example and a very useful one. It answers the question: if a user can ssh from a server A to a server B, can the user ssh back from B to A"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://yingbo.miao.fm/img/og_image.png"><meta property="article:published_time" content="2015-02-16T05:00:00.000Z"><meta property="article:modified_time" content="2021-05-10T20:44:28.573Z"><meta property="article:author" content="Yingbo Miao"><meta property="article:tag" content="ssh"><meta property="article:tag" content="network"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://yingbo.miao.fm/2015/ssh-reverse-tunnel"},"headline":"Yingbo Miao","image":["https://yingbo.miao.fm/img/og_image.png"],"datePublished":"2015-02-16T05:00:00.000Z","dateModified":"2021-05-10T20:44:28.573Z","author":{"@type":"Person","name":"Yingbo Miao"},"description":"The SSH has many advance usages. The reverse tunnel is a good example and a very useful one. It answers the question: if a user can ssh from a server A to a server B, can the user ssh back from B to A"}</script><link rel="canonical" href="https://yingbo.miao.fm/2015/ssh-reverse-tunnel"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/archives">Archives</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-12"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2015-02-16T05:00:00.000Z" title="2/16/2015, 5:00:00 AM">2015-02-16</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-05-10T20:44:28.573Z" title="5/10/2021, 8:44:28 PM">2021-05-10</time></span><span class="level-item"><a class="link-muted" href="/categories/Network/">Network</a></span></div></div><h1 class="title is-3 is-size-4-mobile">SSH Reverse Tunnel</h1><div class="content"><p>The SSH has many advance usages. The reverse tunnel is a good example and a very useful one. It answers the question: if a user can ssh from a server A to a server B, can the user ssh back from B to A, even A is behind a router? In my case, it is very helpful. I have a desktop in the office, but the office VPN has not been set up yet. How can I ssh to my office desktop from home? The answer is SSH reverse tunnel, using a server with a public IP as a jumper. Followings show how did I do it.</p>
<span id="more"></span>
<p>As a start, we need to ssh from the server A (office desktop) to server B (the server with a public IP). It has more parameters than common SSH, to enable reverse tunnel:</p>
<p><code> ssh -R 19999:localhost:22 my_username_on_server_b@serer_b</code>{lang=”bash”}</p>
<p>The port 22 is the office desktop ssh server port. The standard is 22, valid for most of cases. The 19999 is going to be used to ssh port on server B.</p>
<p>Next I ‘ll show how do I ssh back from the server B to my desktop. It’s pretty simple:<br><code> ssh -p 19999 my_username_on_server_a@serer_b</code>{lang=”bash”}</p>
<p>Note how do we use the port 19999. Another important thing is this time we use my_username_on_server_a. In many cases a user uses a same user name on both servers, however, mine are different.</p>
<p>After that I already jump to my office desktop . However, it is possible that the ssh connection from the first step gone. How can I fix it while I am at home? At first I thought I needed a cron job to keep reconnecting, till I found the <a target="_blank" rel="noopener" href="http://www.harding.motd.ca/autossh/" title="Autossh">autossh</a>. The usage is very simple:</p>
<p><code> autossh -M 19990 -f -N -o &quot;PubkeyAuthentication=yes&quot; -o &quot;PasswordAuthentication=no&quot; -R 19999:localhost:22  my_username_on_server_b@serer_b</code>{lang=”bash”}</p>
<p>Now I have a stable connection. Unless the office has a power off, I am pretty safe now.</p>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/ssh/">ssh</a><a class="link-muted mr-2" rel="tag" href="/tags/network/">network</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2015/docker-how-to-delete-everything"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Docker How To Delete Everything</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2011/python-how-to-list-files-under-a-directgory"><span class="level-item">Python how to list files under a directgory</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Blog</a><p class="is-size-7"><span>&copy; 2021 Yingbo Miao</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>